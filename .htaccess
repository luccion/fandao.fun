# Modern rewrite rules for fandao.fun backend
RewriteEngine On

# Handle CORS preflight requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ - [R=200,L]

# API routes - direct to API handler
RewriteRule ^api/(.*)$ backend/src/Api/index.php [QSA,L]

# Static assets from backend/public
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(favicon\.ico|favicon\.svg|ads\.txt|serviceWorker\.js)$ backend/public/$1 [L]

# All other requests to backend router (with fallback to original structure)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ backend/public/index.php [QSA,L]